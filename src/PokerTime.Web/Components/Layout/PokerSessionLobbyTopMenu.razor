@using PokerTime.Domain.Entities

<aside class="menu">
    <TopMenu BrandIsClickable="false">
        <div class="navbar-start navbar-retrospective-start">
            <div class="navbar-item">
                <h1 class="retrospective-title">@this._layoutInfo.Title</h1>
            </div>
        </div>

        <div class="navbar-end">
            <div class="navbar-item retrospective-progress-container">
                <div class="retrospective-progress @(this.CurrentStage == RetrospectiveStage.NotStarted ? "retrospective-progress--inactive" : String.Empty)">
                    <PokerSessionProgressItem 
                        CurrentStage="@this.CurrentStage"
                        ApplicableTo="@RetrospectiveStage.Writing"
                        Text="Write"/>

                    <PokerSessionProgressItem 
                        CurrentStage="@this.CurrentStage"
                        ApplicableTo="@RetrospectiveStage.Discuss"
                        Text="Discuss"/>

                    <PokerSessionProgressItem 
                        CurrentStage="@this.CurrentStage"
                        ApplicableTo="@RetrospectiveStage.Grouping"
                        Text="Group"/>

                    <PokerSessionProgressItem 
                        CurrentStage="@this.CurrentStage"
                        ApplicableTo="@RetrospectiveStage.Voting"
                        Text="Vote"/>

                    <PokerSessionProgressItem 
                        CurrentStage="@this.CurrentStage"
                        ApplicableTo="@RetrospectiveStage.Finished"
                        Text="Finished"/>
                </div>
            </div>
        </div>
    </TopMenu>
</aside>

@code
{
    #nullable disable
    private PokerSessionLayoutInfo _layoutInfo = new PokerSessionLayoutInfo("Loading...");

    private RetrospectiveStage CurrentStage => this._layoutInfo.Stage ?? RetrospectiveStage.NotStarted;

    public void Update(in PokerSessionLayoutInfo layoutInfo)
    {
        this._layoutInfo = layoutInfo;

        this.StateHasChanged();
    }
}
